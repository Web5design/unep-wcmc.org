<div class="container" ng-app="DatasetsResources" ng-controller="DatasetsCtrl" ng-init="init(<%= render partial: "datasets/list", formats: :json %>)">
  <div id="data-small" class="column-1-3">
    <div class="search_field_container">
      <input class="search_input" type="text" placeholder="Search resources or datasets" ng-model="query" ng-change="search()"/>
      <div class="icon_search">
        <i class="icon-search"></i>
      </div>
    </div>
    <select id="sorting" ng-model="sortOrder" ng-options="order.value as order.name for order in sortOrders" ng-change="sortDatesets()">
    </select>
    <button id="content-button">Type of content <i class="icon-caret-down"></i></button>
    <ul id="content-small">
      <li ng-click="toggleContentType()" ng-class="{active: contentType.selected && contentType.count > 0}" class="content_type" ng-repeat="contentType in contentTypes">
        <span class="badge">{{ contentType.count }}</span>
        <p ng-style="{color: contentType.count > 0 ? '#000' : '#ddd'}">{{ contentType.plural }}</p>
      </li>
    </ul>
  </div>
  <div id="data" class="column-1-3">
    <div class="search-field">
      <input class="short" type="text" placeholder="Search resources or datasets" ng-model="query" ng-change="search()" />
      <div class="icon_search">
        <i class="icon-search"></i>
      </div>
    </div>
    <select id="sorting" ng-model="sortOrder" ng-options="order.value as order.name for order in sortOrders" ng-change="sortDatesets()">
    </select>
    <ul id="content">
      <li class="header">
        Type of content
        <span class="badge" ng-click="deselectAll()">None</span>
        <span class="badge">|</span>
        <span class="badge" ng-click="selectAll()">All</span>
      <li ng-click="toggleContentType()" ng-class="{active: contentType.selected && contentType.count > 0}" class="content_type" ng-repeat="contentType in contentTypes">
        <span class="badge">{{ contentType.count }}</span>
        <p ng-style="{color: contentType.count > 0 ? '#000' : '#ddd'}">{{ contentType.plural }}</p>
      </li>
    </ul>
  </div>
  <div id="data" class="column-2-3">
    <h1>
      Resources &amp; data
    </h1>
    <section ng-repeat="dataset in activeDatasets">
      <h2 class="smaller">{{ dataset.title }}</h2>
      <h3>
        {{ dataset.content_type }}
        <span class="separator">|</span>
        {{ dataset.publication_date | date}}
      </h3>
      <p ng-bind-html="dataset.content">
        <%#{{ dataset.content }}%>
      </p>
      <p class="link">
        <a href="{{dataset.first_link}}">{{dataset.first_link_label}}</a>
      </p>
      <p class="link">
        <a href="{{dataset.second_link}}">{{dataset.second_link_label}}</a>
      </p>
    </section>
    <h2 ng-if="activeDatasets.length == 0" class="smaller">No data found.</h2>
  </div>
</div>
